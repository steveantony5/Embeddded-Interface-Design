# EID Project 3

### Introduction
This is the third project in Embedded Interface design course offered at CU Boulder. The project includes temperature polling, storing the data in MySQL database, displaying the temperature and humidity data in PyQT GUI, Node JS server, Tornado webserver and HTML based webclient, connecting to AWS, lambda, SNS and SQS.

### Project Developers
  - Sorabh Gandhi
  - Steve Antony Xavier Kennedy

### Project Work
1.) Steve Antony Xavier Kenndy - SQS and HTML Client

2.)Sorabh Gandhi - MQTT, Lambda and SNS

### Hardware Setup
1.) Connect the 1st Pin of DHT to 3.3V supply pin in Raspberry Pi

2.) Connect the 2nd Pin of DHT to 15th Pin (GPIO 22) in Raspberry Pi

3.) Connect the 4th Pin of DHT to GND pin in Raspberry Pi

4.) Connect a 1k resistor between 1st and the 2nd Pin of DHT

### Installation
Install all the dependencies to run this project. Follow the installation instructions given below,

```sh
$ sudo apt-get install update
$ sudo apt-get install upgrade
$ sudo apt-get install python3-pip
$ sudo apt-get install qt5-default pyqt5-dev pyqt5-dev-tools
$ sudo apt install mariadb-server
$ sudo apt-get install python-mysqldb
$ cd Adafruit_Python_DHT/
$ sudo python3 setup.py install
$ sudo pip3 install pyqtgraph
$ sudo apt-get install build-essential
$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.8/install.sh | bash
$ nvm install 8.9.4
$ wget https://nodejs.org/dist/v8.9.0/node-v8.9.0-linux-armv6l.tar.gz
$ tar -xzf node-v8.9.0-linux-armv6l.tar.gz
$ cd node-v6.11.1-linux-armv6l/
$ sudo cp -R * /usr/local/
$ npm init â€“y
$ npm install mysql
$ npm install mysql -y
$ sudo pip3 install tornado
$ git clone https://github.com/aws/aws-iot-device-sdk-python
$ cd aws-iot-device-sdk-python
$ sudo python setup.py install
```

After installing the Adafruit temperature sensor library, create a username, password and 
database in mardia DB by follwing the below steps,
```sh
$ sudo mysql_secure_installation
```
For secure installation, type 'Y' to all the prompts.
```sh
$ sudo mysql -u root -p
>> CREATE DATABASE sensordb;
>> CREATE USER 'gandhi'@'localhost' IDENTIFIED BY 'sorabh';
>> GRANT ALL PRIVILEGES ON sensordb.* TO 'gandhi'@'localhost';
>> FLUSH PRIVILEGES;
```

### Run Steps
```sh
$ bash kickoff_script.sh
```
	This will launch the PyQT GUI, Tornado Server and websocket-server.js

#### Note
1.) To plot graph, we have used PyQT graph with the approval of the instructor

2.) We have also completed the extra credit part in the PyQT GUI.

#### Files in repository
Application.ui -> GUI created using PyQt designer

project2.py -> main application and implementation of tornado server

mydesign.py -> python file generated by pyuic5 Application.ui -o mydesign.py

dbhandler.py -> Functions related to database

websocket-server.js -> server side implementation for node.js

kickoff_script.sh -> Script to start all the application components - server, pyqt, python app

client.html -> Client side script and UI for web interface

lambda.py -> lambda function for AWS Lambda

#### Reference
1.) https://docs.aws.amazon.com/iot/latest/developerguide/iot-gs.html

2.) https://techblog.calvinboey.com/raspberrypi-aws-iot-python/

3.) https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-making-api-requests.html

4.) https://docs.aws.amazon.com/lambda/latest/dg/with-sns-example.html

5.) https://startupnextdoor.com/adding-to-sqs-queue-using-aws-lambda-and-a-serverless-api-endpoint/

#### Error Handling
We have handled corner cases on sensor removal or sensor getting faulty. Proper error handling for this is included in both client and server.
